<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Italiano</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        .chat-container {
            max-width: 800px;
            margin: 1rem auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 1rem;
            text-align: center;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.8rem 1rem;
            border-radius: 1rem;
            max-width: 85%;
            word-wrap: break-word;
        }

        .user-message {
            background: #e3f2fd;
            margin-left: auto;
            border-bottom-right-radius: 0.2rem;
        }

        .bot-message {
            background: #f5f5f5;
            margin-right: auto;
            border-bottom-left-radius: 0.2rem;
        }

        .chat-input {
            display: flex;
            padding: 1rem;
            background: #f5f5f5;
            border-top: 1px solid #ddd;
            position: sticky;
            bottom: 0;
        }

        .chat-input input {
            flex: 1;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 0.5rem;
            font-size: 1rem;
        }

        .chat-input button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.2rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }

        .chat-input button:hover {
            background: #006634;
        }

        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 1rem;
            background: #f9f9f9;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .suggestion-btn {
            background: white;
            border: 1px solid #ddd;
            padding: 0.8rem 1rem;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .suggestion-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            padding: 1rem;
        }

        .category-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .category-card i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .italian-word {
            color: var(--primary);
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .italian-word:hover {
            text-decoration: underline;
        }

        .audio-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            padding: 0.3rem;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .audio-btn:hover {
            background: rgba(0,0,0,0.05);
        }

        @media (max-width: 768px) {
            .chat-container {
                margin: 0;
                height: calc(100vh - 120px);
                border-radius: 0;
            }

            .categories {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }

            .message {
                max-width: 90%;
                font-size: 0.95rem;
            }

            .chat-input input {
                font-size: 16px; /* Previene zoom en iOS */
            }

            .suggestion-btn {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
            }

            header {
                padding: 1rem;
            }

            header h1 {
                font-size: 1.5rem;
            }

            header p {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">Italiano Pareto</div>
        <ul>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="alfabeto.html">Alfabeto</a></li>
            <li><a href="numeros.html">Números</a></li>
            <li><a href="colores.html">Colores</a></li>
            <li><a href="verbos.html">Verbos</a></li>
            <li><a href="chat.html" class="active">Chat</a></li>
        </ul>
    </nav>

    <div class="container">
        <header>
            <h1><i class="fas fa-comments"></i> Chat de Italiano</h1>
            <p>Practica italiano con nuestro chat inteligente. Haz preguntas sobre gramática, vocabulario, verbos y más.</p>
        </header>

        <div class="chat-container">
            <div class="chat-messages" id="chatMessages"></div>
            
            <div class="suggestions" id="suggestions">
                <!-- Las sugerencias se cargarán dinámicamente -->
            </div>

            <div class="chat-input">
                <input type="text" id="userInput" placeholder="Escribe tu mensaje..." onkeypress="if(event.key === 'Enter') sendMessage()">
                <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>

        <div class="categories">
            <div class="category-card" onclick="loadCategory('verbs')">
                <i class="fas fa-running"></i>
                <h3>Verbos</h3>
                <p>Conjugaciones y usos</p>
            </div>
            <div class="category-card" onclick="loadCategory('vocabulary')">
                <i class="fas fa-book"></i>
                <h3>Vocabulario</h3>
                <p>Palabras y significados</p>
            </div>
            <div class="category-card" onclick="loadCategory('phrases')">
                <i class="fas fa-comments"></i>
                <h3>Frases</h3>
                <p>Expresiones comunes</p>
            </div>
        </div>
    </div>

    <script>
        let synth = window.speechSynthesis;
        let italianVoice = null;

        // Categorías predefinidas con ejemplos
        const categoryContent = {
            verbs: [
                "¿Cómo se conjuga el verbo essere en presente?",
                "¿Cuál es el pasado de andare?",
                "¿Cómo se usa el verbo avere?",
                "Explica el verbo fare"
            ],
            vocabulary: [
                "¿Cómo se dice 'buenos días'?",
                "¿Qué significa 'grazie mille'?",
                "Palabras para la comida",
                "Vocabulario de viajes"
            ],
            phrases: [
                "Frases para el restaurante",
                "¿Cómo pedir direcciones?",
                "Expresiones cotidianas",
                "Saludos y despedidas"
            ]
        };

        function loadCategory(category) {
            const suggestions = document.getElementById('suggestions');
            suggestions.innerHTML = '';
            
            categoryContent[category].forEach(question => {
                const button = document.createElement('button');
                button.className = 'suggestion-btn';
                button.textContent = question;
                button.onclick = () => askQuestion(question);
                suggestions.appendChild(button);
            });
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            
            if (text) {
                addMessage(text, 'user');
                input.value = '';
                
                // Simular respuesta del bot
                setTimeout(() => {
                    const response = "Lo siento, aún estoy aprendiendo a responder. Por favor, usa los botones de sugerencias para practicar.";
                    addMessage(response, 'bot');
                }, 1000);
            }
        }

        function addMessage(text, type) {
            const messages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            
            if (type === 'bot') {
                const words = text.split(' ');
                const formattedText = words.map(word => {
                    if (word.match(/^[A-Za-zÀ-ÿ]{2,}$/)) {
                        return `<span class="italian-word" onclick="speak('${word}')">${word} <button class="audio-btn" onclick="event.stopPropagation(); speak('${word}')"><i class="fas fa-volume-up"></i></button></span>`;
                    }
                    return word;
                }).join(' ');
                messageDiv.innerHTML = formattedText;
            } else {
                messageDiv.textContent = text;
            }
            
            messages.appendChild(messageDiv);
            messages.scrollTop = messages.scrollHeight;
        }

        function askQuestion(question) {
            addMessage(question, 'user');
            // Aquí iría la lógica para procesar la pregunta y generar una respuesta
        }

        function speak(text) {
            if (synth.speaking) {
                synth.cancel();
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = italianVoice;
            utterance.rate = 1.0; // Velocidad normal
            utterance.pitch = 1.0; // Tono normal
            utterance.volume = 1.0; // Volumen máximo
            utterance.lang = 'it-IT';
            
            synth.speak(utterance);
        }

        // Inicializar la voz italiana
        synth.onvoiceschanged = () => {
            const voices = synth.getVoices();
            italianVoice = voices.find(voice => voice.lang.includes('it-IT'));
        };

        // Mensaje inicial al cargar la página
        window.onload = () => {
            addMessage("Ciao! Sono qui per aiutarti a praticare l'italiano. Selecciona una categoría para empezar.", 'bot');
            loadCategory('phrases');
        };
    </script>
</body>
</html>
